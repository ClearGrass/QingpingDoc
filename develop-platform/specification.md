# 规范说明

- [规范说明](#规范说明)
  - [1. 接口规范](#1-接口规范)
    - [1.1 通信协议](#11-通信协议)
    - [1.2 请求方法](#12-请求方法)
    - [1.3 Oauth Access Token 获取](#13-oauth-access-token-获取)
    - [1.4 格式说明](#14-格式说明)
    - [1.5 请求接口返回状态说明](#15-请求接口返回状态说明)
    - [1.6 其他说明](#16-其他说明)
  - [2. 设备列表及属性支持说明](#2-设备列表及属性支持说明)
    - [2.1 产品列表](#21-产品列表)
    - [2.2 设备属性及各设备支持情况如下](#22-设备属性及各设备支持情况如下)
    - [2.3 设备事件及各设备支持情况如下](#23-设备事件及各设备支持情况如下)

## 1. 接口规范

### 1.1 通信协议

```markdown
    协议: HTTPS
    域名: apis.cleargrass.com
```

### 1.2 请求方法

```markdown
    支持方式 GET POST DELETE PUT
```

### 1.3 Oauth Access Token 获取

所有请求均需要携带 Access Token 请求头，Access Token 获取方式参见 [接口授权](/main/oauthApi)

### 1.4 格式说明

接口请求中元素出现要求说明：

| 符号 | 说明                                        |
| ---- | ------------------------------------------- |
| R    | 报文中该元素必须出现（Required）            |
| O    | 报文中该元素可选出现（Optional）            |
| C    | 报文中该元素在一定条件下出现（Conditional） |

### 1.5 请求接口返回状态说明

请求返回的HTTP状态码说明如下

| 状态码 | 说明                           |
| ------ | ------------------------------ |
| 200    | 请求处理成功                   |
| 400    | 请求错误，缺失参数或格式不对等 |
| 401    | 缺少头部认证信息               |
| 403    | 请求的资源没有权限             |
| 404    | 请求的资源不存在               |
| 409    | 请求冲突                       |
| 408    | 请求时间过期，请重新请求       |
| 500    | 服务器内部错误                 |
| 503    | 服务暂时不可用                 |

### 1.6 其他说明

1. 返回的其他信息以Json形式存放于Body中，头部类型为 "Content-Type: application/json"
2. 返回200以外的状态码时，错误信息格式如下：

```json
{
    "msg": "xx"
}
```

------

## 2. 设备列表及属性支持说明

### 2.1 产品列表

| 产品编号 | 名称             |
| -------- | ---------------- |
| 1001     | 青萍商用温湿度计 |
| 1101     | 青萍温湿度气压计 |
| 1201     | 青萍空气检测仪   |

### 2.2 设备属性及各设备支持情况如下

| 属性标示         | 属性描述     | 分量 | 赋值      | 属性值单位/属性等级说明             | 青萍商用温湿度计 | 青萍温湿度气压计 | 青萍空气检测仪 |
| ---------------- | ------------ | ---- | --------- | ----------------------------------- | ---------------- | ---------------- | -------------- |
| battery          | 电量         | 值   | 数字      | %                                   | Y                | Y                | Y              |
|                  |              | 状态 | discharge | 未连接电源                          |                  |                  | Y              |
|                  |              | 状态 | charging  | 连接电源                            |                  |                  | Y              |
| signal           | 信号         | 值   | 数字      | 为负数,数值越大信号越强，如:-50>-90 | Y                | Y                |                |
| timestamp        | 时间         | 值   | 数字      | s                                   | Y                | Y                | Y              |
| temperature      | 温度         | 值   | 数字      | C                                   | Y                | Y                | Y              |
|                  |              | 状态 | abnormal  | 传感器异常                          |                  |                  | Y              |
|                  |              | 状态 | preparing | 传感器准备中                        |                  |                  | Y              |
|                  |              | 状态 | sampling  | 传感器采集中                        |                  |                  | Y              |
| prob_temperature | 外接探头温度 | 值   | 数字      | C                                   | Y                |                  |                |
| humidity         | 湿度         | 值   | 数字      | %                                   | Y                | Y                | Y              |
|                  |              | 状态 | abnormal  | 传感器异常                          |                  |                  | Y              |
|                  |              | 状态 | preparing | 传感器准备中                        |                  |                  | Y              |
|                  |              | 状态 | sampling  | 传感器采集中                        |                  |                  | Y              |
| pressure         | 气压         | 值   | 数字      | kpa                                 |                  | Y                |                |
| pm10             | PM1.0        | 值   | 数字      | μg/m³                               |                  |                  | Y              |
| pm50             | PM5.0        | 值   | 数字      | μg/m³                               |                  |                  | Y              |
| pm25             | PM2.5        | 值   | 数字      | μg/m³                               |                  |                  | Y              |
|                  |              | 状态 | abnormal  | 传感器异常                          |                  |                  | Y              |
|                  |              | 状态 | preparing | 传感器准备中                        |                  |                  | Y              |
|                  |              | 状态 | idle      | 传感器空闲中                        |                  |                  | Y              |
|                  |              | 状态 | sampling  | 传感器采集中                        |                  |                  | Y              |
| pm100            | PM10         | 值   | 数字      | μg/m³                               |                  |                  |                |
| co2              | Co2          | 值   | 数字      | ppb                                 |                  |                  | Y              |
| tvoc             | 挥发物质     | 值   | 数字      | ppb                                 |                  |                  | Y              |
|                  |              | 状态 | abnormal  | 传感器异常                          |                  |                  | Y              |
|                  |              | 状态 | preparing | 传感器准备中                        |                  |                  | Y              |
|                  |              | 状态 | initing   | 传感器初始化中                      |                  |                  | Y              |
|                  |              | 状态 | sampling  | 传感器采集中                        |                  |                  | Y              |
| radon            | 氡           | 值   | 数字      | pCi/L                               |                  |                  |                |

***说明：*** Y 表示该类型设备支持此属性字段

### 2.3 设备事件及各设备支持情况如下

| 属性标示         | 属性描述     | 操作符 | 阈值 | 说明                  | 青萍商用温湿度计 | 青萍温湿度气压计 | 青萍空气检测仪 |
| ---------------- | ------------ | ------ | ---- | --------------------- | ---------------- | ---------------- | -------------- |
| battery          | 电量         | lt     | 15   | 电量低于15%           | Y                | Y                |                |
| timestamp        | 时间         | gt     |      | 设备离线2个上报周期   | Y                | Y                |                |
| temperature      | 温度         | gt/lt  | 数字 | 设备温度高于/低于某值 | Y                | Y                |                |
| humidity         | 湿度         | gt/lt  | 数字 | 设备湿度高于/低于某值 | Y                | Y                |                |
| pressure         | 气压         | gt/lt  | 数字 | 设备湿度高于/低于某值 |                  | Y                |                |
| prob_temperature | 外接探头温度 | gt/lt  | 数字 | 设备温度高于/低于某值 | Y                |                  |                |

***说明：*** Y 表示该类型设备支持此属性字段
